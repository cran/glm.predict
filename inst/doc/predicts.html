<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Benjamin E. Schlegel" />

<meta name="date" content="2022-12-02" />

<title>Introduction to glm.predict</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to glm.predict</h1>
<h4 class="author">Benjamin E. Schlegel</h4>
<h4 class="date">2022-12-02</h4>



<p>After estimating a model, it is often not straight forward to
interpret the model output. An easy way of interpretation is to use
predicted probabilities/values as well as discrete changes (the
difference between two of the former). We usually want confidence
intervals with those values to have an idea how exact they are and if
the are significant or not. There are basically two approaches to
estimate confidence intervals: simulation and bootstrap. Both approaches
have in common that they draw 1000 (or more) Coefficients (<span class="math inline">\(\beta\)</span>s). Those can be used to calculate
the predicted value (<span class="math inline">\(\hat{y}\)</span>) given
a specific set a x-values we are interested in. Depending on the model
we need an inverse link function to get the resulting probability/value.
With the resulting 1000 (or more) values we are then able to calculate
not only the mean but also the confidence interval using quantiles.</p>
<div id="simulation-and-bootstrap-explained" class="section level2">
<h2>Simulation and Bootstrap explained</h2>
<div id="simulation" class="section level3">
<h3>Simulation</h3>
<p><em>Monte Carlo simulation</em> uses the property that the
coefficients are asymptotically multivariate normal distributed.
Asymptotically means that the number of cases should be high.</p>
<p>In R this is straight forward: The package <strong>MASS</strong>
contains a function <code>mvrnorm()</code>. The parameter n are the
number of draws (e.g. 1000), mu are the coefficients and Sigma the
variance-covariance matrix.</p>
<p>A quick example:</p>
<p>We want to estimate the predicted probability to participate in the
Swiss national election 2015 for a 30 year old woman. As younger women
participate as often as young men or even more but older women
participate less then older men, we include an interaction between age
and gender in our logistic regression.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df_selects <span class="ot">=</span> selects2015</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">=</span> <span class="fu">glm</span>(participation <span class="sc">~</span> age <span class="sc">*</span> gender, <span class="at">family =</span> binomial, <span class="at">data =</span> df_selects)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = participation ~ age * gender, family = binomial, 
##     data = df_selects)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2353  -1.2322   0.6892   0.8729   1.1768  
## 
## Coefficients:
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -0.656152   0.126185  -5.200 1.99e-07 ***
## age               0.036530   0.002728  13.390  &lt; 2e-16 ***
## genderfemale      0.265886   0.171467   1.551 0.120983    
## age:genderfemale -0.012976   0.003600  -3.604 0.000313 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 6332.8  on 5197  degrees of freedom
## Residual deviance: 6007.8  on 5194  degrees of freedom
##   (139 Beobachtungen als fehlend gelöscht)
## AIC: 6015.8
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Next we simulate 1000 Coefficients.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">=</span> <span class="fu">coef</span>(logit_model)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>vcov <span class="ot">=</span> <span class="fu">vcov</span>(logit_model)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>betas_simulated <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">1000</span>, betas, vcov)</span></code></pre></div>
<p>With the simulated coefficients we can now estimate <span class="math inline">\(\hat{y}\)</span>. x we set to 1 (for the
intercept), 30 (for age), 1 (for genderfemale) and 30 (<span class="math inline">\(1 (female) \cdot30(age)\)</span> for
age:genderfemale).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">30</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> betas_simulated <span class="sc">%*%</span> x</span></code></pre></div>
<p>As the <span class="math inline">\(\hat{y}\)</span> is on the logit
scale, we have to use the inverse link function for logit:</p>
<p><span class="math display">\[
\pi = \frac{e^{\hat{y}}}{1 + e^{\hat{y}}}
\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>predProb <span class="ot">=</span> <span class="fu">exp</span>(yhat) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(yhat))</span></code></pre></div>
<p>Now we can calculate the mean and the 95%-confidence interval.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(predProb)</span></code></pre></div>
<pre><code>## [1] 0.5780147</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(predProb, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.5525980 0.6050431</code></pre>
<p>We see that a 30-year old woman has a probability to participate in
the national election in Switzerland of about 58% with a confidence
interval from 55% to 61%.</p>
</div>
<div id="bootstrap" class="section level3">
<h3>Bootstrap</h3>
<p><em>Bootstrap</em> on the other hand estimates the model multiple
times with each time a slightly different dataset. The data is sampled
from the real dataset with the property that one case can be sampled
multiple time. At the end there will be datasets were the an outlier is
multiple times in the the data and another where it is not in the data
at all. Doing this 1000 times (or more) gives 1000 (or more)
coefficients. The benefit of this approach is that it also works with
smaller datasets. The downside is that it takes longer as reestimating
the model 1000 times takes time.</p>
<p>We do the sample example again but this time with bootstrap. We use
again the same model. This time we draw the 1000 coefficients with
estimating the model 1000 times.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">=</span> <span class="cf">function</span>(x, model){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">model.frame</span>(model)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  data_sample <span class="ot">=</span> data[<span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(<span class="fu">update</span>(model, <span class="at">data =</span> data_sample))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>betas_boot <span class="ot">=</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, boot, logit_model))</span></code></pre></div>
<p>The rest is identical.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">30</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> betas_boot <span class="sc">%*%</span> x</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>predProb <span class="ot">=</span> <span class="fu">exp</span>(yhat) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(yhat))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(predProb)</span></code></pre></div>
<pre><code>## [1] 0.5782755</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(predProb, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.5496272 0.6060803</code></pre>
</div>
<div id="discrete-changes" class="section level3">
<h3>Discrete Changes</h3>
<p>For discrete changes the idea is exactly the same. But here we
calculate with the drawn coefficients predProb1 and predProb2 with each
another x. The 1000 discrete changes are the difference between
predProb1 and predProb2. With those we can again calculate mean and
confidence intervals.</p>
</div>
</div>
<div id="using-the-package" class="section level2">
<h2>Using the package</h2>
<p>After we covered the idea behind the two approaches, we see how the
package helps us doing the job. The two S3-functions
<code>basepredict()</code> and <code>dc()</code> do basically exactly
the same as the examples above (<code>model</code> is the model,
<code>values</code> the x, <code>sim.count</code> how many draws we want
(default: 1000), <code>conf.int</code> the confidence interval (default:
0.95), <code>simga</code> allows us to add a corrected
variance-covariance matrix, <code>set.seed</code> allows to set a seed
and <code>type</code> gives the possibility to choose between simulation
and bootstrap). Much more convenient however is the function
<code>predicts()</code> which allows to calculate multiple values at
once.</p>
<p>The function <code>predicts()</code> needs the model and the wanted
values as a character. Other than with the base functions
<code>basepredict()</code> and <code>dc()</code> we specify the values
for each variable and not for each coefficient. What we can specify
depends on the variable type.</p>
<ul>
<li>Factors / Character</li>
</ul>
<p>If you want all values of a factor/character you simply can write a
“F”. If you only want to have certain values, you can tell which one you
want in (). Lets suppose we have factor country with 26 countries, but
we only want the 3rd, the 7th and the 21st country, then we would write
“F(3,7,21)”. We can also just use the mode value with “mode”.</p>
<ul>
<li>Numeric</li>
</ul>
<p>If we have a numeric variable, we have a lot more possibilities. We
can again use the mode by writing “mode”, but also the “median” or the
“mean”, we can use “min” or “max”, if we want quartile we can write
“Q4”, for quintiles “Q5” or in general “Q#” where # stand for any whole
number (e.g. “Q2” would add the min, median and max-value). We can also
write just any number like “-34.43”, but also two numbers separated with
a minus-sign to get all number between the two number (e.g. “1-100”
would give 1, 2, 3, …, 100). If you want a different step then 1 you can
add the step after a comma (e.g. “-3.1-9.7,0.2” would give -3.1, -2.9,
-2.7, …, 9.7). You can also just add multiple number separated by comma
(e.g. “3,7.2,9.3”). The last four possibilities we can also surround by
a “log()” to include the log of those numbers
(e.g. “log(100-1000,100)”).</p>
<p>The parameter <code>position</code> is for discrete changes. If it is
null the function return predicted probabilities/values. If we want
discrete changes we have to tell for which variable (position). Lets
suppose we want to have discrete changes for the 2nd variable, then we
would write <code>position=2</code>. The other parameters of the
functions are <code>sim.count</code> to change the number of draws,
<code>conf.int</code> to change the confidence interval from a 95% to
for example a 90% (you would write <code>conf.int = 0.9</code>),
<code>simga</code> for a corrected variance-covariance matrix (for
example when you correct it for heteroscedasticity),
<code>set.seed</code> to set a seed for replication, doPar if you face
trouble with the parallel version and want to try to run it sequential
(multinom() is always sequential) and <code>type</code> to choose
between simulation and bootstrap. If not set the choice depends on the
number of cases in the dataset.</p>
<div id="example" class="section level3">
<h3>Example</h3>
<p>We estimate ordinal logistic regression with the opinion if
Switzerland should be part of the European Union
(<code>opinion_eu_membership</code>) as dependent variable. As
independent variable we take the interaction between elected party
(<code>vote_choice</code>) and left-right self position
(<code>lr_self</code>) and as control variables age and gender.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_selects <span class="ot">=</span> selects2015</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ologit_model <span class="ot">=</span> <span class="fu">polr</span>(opinion_eu_membership <span class="sc">~</span> vote_choice <span class="sc">*</span> lr_self <span class="sc">+</span> age <span class="sc">+</span> gender, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df_selects, <span class="at">Hess =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ologit_model)</span></code></pre></div>
<pre><code>## Call:
## polr(formula = opinion_eu_membership ~ vote_choice * lr_self + 
##     age + gender, data = df_selects, Hess = TRUE)
## 
## Coefficients:
##                             Value Std. Error t value
## vote_choiceFDP           -0.89529   0.460035 -1.9461
## vote_choiceBDP           -2.01165   0.685942 -2.9327
## vote_choiceCVP           -2.00358   0.480561 -4.1693
## vote_choiceGLP           -1.35016   0.530441 -2.5454
## vote_choiceSP            -2.02427   0.354073 -5.7171
## vote_choiceGPS           -2.36429   0.393877 -6.0026
## vote_choiceother         -1.97721   0.402018 -4.9182
## lr_self                   0.19294   0.043391  4.4466
## age                      -0.01926   0.001933 -9.9644
## genderfemale              0.09259   0.067575  1.3703
## vote_choiceFDP:lr_self   -0.04832   0.063849 -0.7567
## vote_choiceBDP:lr_self    0.15831   0.109466  1.4462
## vote_choiceCVP:lr_self    0.14511   0.071865  2.0192
## vote_choiceGLP:lr_self   -0.03126   0.100826 -0.3100
## vote_choiceSP:lr_self     0.10193   0.057970  1.7583
## vote_choiceGPS:lr_self    0.23998   0.078816  3.0448
## vote_choiceother:lr_self  0.28552   0.059949  4.7627
## 
## Intercepts:
##                                                             Value    Std. Error
## Strongly for EU entry|Rather for EU entry                    -4.8574   0.3665  
## Rather for EU entry|Neither nor                              -2.8368   0.3535  
## Neither nor|Rather in favour to stay out                     -1.7165   0.3505  
## Rather in favour to stay out|Strongly in favour to stay out   0.0902   0.3485  
##                                                             t value 
## Strongly for EU entry|Rather for EU entry                   -13.2527
## Rather for EU entry|Neither nor                              -8.0240
## Neither nor|Rather in favour to stay out                     -4.8978
## Rather in favour to stay out|Strongly in favour to stay out   0.2589
## 
## Residual Deviance: 8018.673 
## AIC: 8060.673 
## (2151 Beobachtungen als fehlend gelöscht)</code></pre>
<p>Next we estimate predicted probabilities for the left right positions
0, 5 and 10 for all parties. For age we take the mean, for gender the
mode.</p>
<pre><code>## Type not specified: Using simulation as n &gt;= 500</code></pre>
<pre><code>##         mean      lower      upper vote_choice lr_self     age gender
## 1 0.02134143 0.01102887 0.03760666         SVP       0 51.2103   male
## 2 0.11776616 0.06704934 0.18646761         SVP       0 51.2103   male
## 3 0.18776108 0.12764672 0.24774631         SVP       0 51.2103   male
## 4 0.41248392 0.36917149 0.43840804         SVP       0 51.2103   male
## 5 0.26064742 0.15712217 0.39235339         SVP       0 51.2103   male
## 6 0.05098232 0.02459382 0.08643541         FDP       0 51.2103   male
##                            level
## 1          Strongly for EU entry
## 2            Rather for EU entry
## 3                    Neither nor
## 4   Rather in favour to stay out
## 5 Strongly in favour to stay out
## 6          Strongly for EU entry</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_pred <span class="ot">=</span> <span class="fu">predicts</span>(ologit_model, <span class="st">&quot;F;0,5,10;mean;mode&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_pred)</span></code></pre></div>
<p>We get back a data.frame. Next we estimate the discrete change
between a SVP and a SP voter for all values of left-right.</p>
<pre><code>## Type not specified: Using simulation as n &gt;= 500</code></pre>
<pre><code>##    val1_mean  val1_lower val1_upper  val2_mean val2_lower val2_upper
## 1 0.02112410 0.010469103 0.03958894 0.13771926 0.10723541 0.17510685
## 2 0.11734519 0.063139849 0.19529860 0.40792205 0.36708309 0.44707947
## 3 0.18658012 0.123397191 0.25326379 0.23995080 0.21325392 0.26438859
## 4 0.41137503 0.364267559 0.43814584 0.17123854 0.14128118 0.20499635
## 5 0.26357557 0.148689806 0.39377683 0.04316936 0.03341204 0.05577599
## 6 0.01776464 0.009315251 0.03095842 0.10581819 0.08389054 0.13212721
##       dc_mean   dc_lower    dc_upper vote_choice_val1 vote_choice_val2 lr_self
## 1 -0.11659516 -0.1544297 -0.08247586              SVP               SP       0
## 2 -0.29057687 -0.3578215 -0.20356800              SVP               SP       0
## 3 -0.05337068 -0.1219359  0.01289787              SVP               SP       0
## 4  0.24013649  0.1869568  0.28112300              SVP               SP       0
## 5  0.22040622  0.1046316  0.35409768              SVP               SP       0
## 6 -0.08805355 -0.1144831 -0.06621289              SVP               SP       1
##       age gender                          level
## 1 51.2103   male          Strongly for EU entry
## 2 51.2103   male            Rather for EU entry
## 3 51.2103   male                    Neither nor
## 4 51.2103   male   Rather in favour to stay out
## 5 51.2103   male Strongly in favour to stay out
## 6 51.2103   male          Strongly for EU entry</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_dc <span class="ot">=</span> <span class="fu">predicts</span>(ologit_model, <span class="st">&quot;F(1,6);0-10;mean;mode&quot;</span>, <span class="at">position =</span> <span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_dc)</span></code></pre></div>
<p>We can now plot the discrete change using
<strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># put the levels in the right order</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df_dc<span class="sc">$</span>level <span class="ot">=</span> <span class="fu">factor</span>(df_dc<span class="sc">$</span>level, <span class="at">levels =</span> <span class="fu">levels</span>(df_selects<span class="sc">$</span>opinion_eu_membership))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_dc, <span class="fu">aes</span>(<span class="at">x =</span> lr_self, <span class="at">y =</span> dc_mean, <span class="at">ymin =</span> dc_lower, <span class="at">ymax =</span> dc_upper)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>level) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;discrete change between SP and SVP&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;left-right position&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Opinion if Switzerland should join the EU&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
